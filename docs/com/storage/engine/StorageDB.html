<!DOCTYPE HTML>
<html lang="ru">
<head>
<!-- Generated by javadoc (17) on Thu May 25 17:24:23 MSK 2023 -->
<title>StorageDB</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2023-05-25">
<meta name="description" content="declaration: package: com.storage.engine, class: StorageDB">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/StorageDB.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field-detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">com.storage.engine</a></div>
<h1 title="Class StorageDB" class="title">Class StorageDB</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">com.storage.engine.StorageDB</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">StorageDB</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">The <a href="StorageDB.html" title="class in com.storage.engine"><code>StorageDB</code></a> class represents a key-value storage database (that stores data in a database file).
 It provides methods for storing, retrieving, and managing data in the database.
 <p>
 Protocol: key (4 bytes) | value (fixed bytes).</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>private final <a href="Buffer.html" title="class in com.storage.engine">Buffer</a></code></div>
<div class="col-second even-row-color"><code><a href="#buffer" class="member-name-link">buffer</a></code></div>
<div class="col-last even-row-color">
<div class="block">Buffer used for caching data before flushing to disk.</div>
</div>
<div class="col-first odd-row-color"><code>private long</code></div>
<div class="col-second odd-row-color"><code><a href="#bytesInWalFile" class="member-name-link">bytesInWalFile</a></code></div>
<div class="col-last odd-row-color">
<div class="block">The total number of bytes stored in the WAL file.</div>
</div>
<div class="col-first even-row-color"><code>private static final <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></code></div>
<div class="col-second even-row-color"><code><a href="#commonCompactionSync" class="member-name-link">commonCompactionSync</a></code></div>
<div class="col-last even-row-color">
<div class="block">The common synchronization object used for coordinating compaction operations across multiple
 instances.</div>
</div>
<div class="col-first odd-row-color"><code>private final <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></code></div>
<div class="col-second odd-row-color"><code><a href="#compactionLock" class="member-name-link">compactionLock</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Lock object used for synchronizing compaction operations.</div>
</div>
<div class="col-first even-row-color"><code>(package private) <a href="CompactionState.html" title="class in com.storage.engine">CompactionState</a></code></div>
<div class="col-second even-row-color"><code><a href="#compactionState" class="member-name-link">compactionState</a></code></div>
<div class="col-last even-row-color">
<div class="block">The state of compaction.</div>
</div>
<div class="col-first odd-row-color"><code>private final <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></code></div>
<div class="col-second odd-row-color"><code><a href="#compactionSync" class="member-name-link">compactionSync</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Synchronization object used for coordinating compaction operations.</div>
</div>
<div class="col-first even-row-color"><code>private final <a href="Config.html" title="class in com.storage.engine">Config</a></code></div>
<div class="col-second even-row-color"><code><a href="#conf" class="member-name-link">conf</a></code></div>
<div class="col-last even-row-color">
<div class="block">The configuration settings for the database.</div>
</div>
<div class="col-first odd-row-color"><code>private <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a></code></div>
<div class="col-second odd-row-color"><code><a href="#dataFile" class="member-name-link">dataFile</a></code></div>
<div class="col-last odd-row-color">
<div class="block">The data file used for storing key-value data.</div>
</div>
<div class="col-first even-row-color"><code>private <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/BitSet.html" title="class or interface in java.util" class="external-link">BitSet</a></code></div>
<div class="col-second even-row-color"><code><a href="#dataInWalFile" class="member-name-link">dataInWalFile</a></code></div>
<div class="col-last even-row-color">
<div class="block">A BitSet indicating which data entries are stored in the WAL file.</div>
</div>
<div class="col-first odd-row-color"><code>private final <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a></code></div>
<div class="col-second odd-row-color"><code><a href="#dbDirFile" class="member-name-link">dbDirFile</a></code></div>
<div class="col-last odd-row-color">
<div class="block">The directory where the database files are stored.</div>
</div>
<div class="col-first even-row-color"><code>private static boolean</code></div>
<div class="col-second even-row-color"><code><a href="#esShutDown" class="member-name-link">esShutDown</a></code></div>
<div class="col-last even-row-color">
<div class="block">Flag indicating whether the executor service is shut down.</div>
</div>
<div class="col-first odd-row-color"><code>(package private) <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Throwable.html" title="class or interface in java.lang" class="external-link">Throwable</a></code></div>
<div class="col-second odd-row-color"><code><a href="#exceptionDuringBackgroundOps" class="member-name-link">exceptionDuringBackgroundOps</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Throwable object representing an exception occurred during background operations.</div>
</div>
<div class="col-first even-row-color"><code>private static <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ExecutorService.html" title="class or interface in java.util.concurrent" class="external-link">ExecutorService</a></code></div>
<div class="col-second even-row-color"><code><a href="#executorService" class="member-name-link">executorService</a></code></div>
<div class="col-last even-row-color">
<div class="block">The executor service for running background tasks.</div>
</div>
<div class="col-first odd-row-color"><code>private static final <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color"><code><a href="#FILE_NAME_DATA" class="member-name-link">FILE_NAME_DATA</a></code></div>
<div class="col-last odd-row-color">
<div class="block">The data-file name.</div>
</div>
<div class="col-first even-row-color"><code>private static final <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color"><code><a href="#FILE_NAME_WAL" class="member-name-link">FILE_NAME_WAL</a></code></div>
<div class="col-last even-row-color">
<div class="block">The WAL-file name.</div>
</div>
<div class="col-first odd-row-color"><code>private static final <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color"><code><a href="#FILE_TYPE_NEXT" class="member-name-link">FILE_TYPE_NEXT</a></code></div>
<div class="col-last odd-row-color">
<div class="block">The pointer-name for next file.</div>
</div>
<div class="col-first even-row-color"><code>private final <a href="file_access/RandomAccessFilePool.html" title="class in com.storage.engine.file_access">RandomAccessFilePool</a></code></div>
<div class="col-second even-row-color"><code><a href="#filePool" class="member-name-link">filePool</a></code></div>
<div class="col-last even-row-color">
<div class="block">Pool of random access files used for reading and writing data.</div>
</div>
<div class="col-first odd-row-color"><code>private final <a href="map/IndexMap.html" title="interface in com.storage.engine.map">IndexMap</a></code></div>
<div class="col-second odd-row-color"><code><a href="#index" class="member-name-link">index</a></code></div>
<div class="col-last odd-row-color">
<div class="block">The index map that stores key-value pairs.</div>
</div>
<div class="col-first even-row-color"><code>private static final <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/ArrayList.html" title="class or interface in java.util" class="external-link">ArrayList</a>&lt;<a href="StorageDB.html" title="class in com.storage.engine">StorageDB</a>&gt;</code></div>
<div class="col-second even-row-color"><code><a href="#instancesServed" class="member-name-link">instancesServed</a></code></div>
<div class="col-last even-row-color">
<div class="block">The list of StorageDB instances served.</div>
</div>
<div class="col-first odd-row-color"><code>private long</code></div>
<div class="col-second odd-row-color"><code><a href="#lastBufferFlushTimeMs" class="member-name-link">lastBufferFlushTimeMs</a></code></div>
<div class="col-last odd-row-color">
<div class="block">The timestamp of the last buffer flush operation in milliseconds.</div>
</div>
<div class="col-first even-row-color"><code>private static final org.slf4j.Logger</code></div>
<div class="col-second even-row-color"><code><a href="#LOG" class="member-name-link">LOG</a></code></div>
<div class="col-last even-row-color">
<div class="block">The logger for logging messages related to the StorageDB class.</div>
</div>
<div class="col-first odd-row-color"><code>private final int</code></div>
<div class="col-second odd-row-color"><code><a href="#recordSize" class="member-name-link">recordSize</a></code></div>
<div class="col-last odd-row-color">
<div class="block">The size of each record in the database.</div>
</div>
<div class="col-first even-row-color"><code>static final int</code></div>
<div class="col-second even-row-color"><code><a href="#RESERVED_KEY_MARKER" class="member-name-link">RESERVED_KEY_MARKER</a></code></div>
<div class="col-last even-row-color">
<div class="block">Marker for reserved keys.</div>
</div>
<div class="col-first odd-row-color"><code>private final <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/locks/ReentrantReadWriteLock.html" title="class or interface in java.util.concurrent.locks" class="external-link">ReentrantReadWriteLock</a></code></div>
<div class="col-second odd-row-color"><code><a href="#rwLock" class="member-name-link">rwLock</a></code></div>
<div class="col-last odd-row-color">
<div class="block">ReentrantReadWriteLock used for synchronization of read and write operations.</div>
</div>
<div class="col-first even-row-color"><code>private boolean</code></div>
<div class="col-second even-row-color"><code><a href="#shutDown" class="member-name-link">shutDown</a></code></div>
<div class="col-last even-row-color">
<div class="block">Flag indicating whether the database is shut down.</div>
</div>
<div class="col-first odd-row-color"><code>private <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Thread.html" title="class or interface in java.lang" class="external-link">Thread</a></code></div>
<div class="col-second odd-row-color"><code><a href="#tWorker" class="member-name-link">tWorker</a></code></div>
<div class="col-last odd-row-color">
<div class="block">The worker thread responsible for background operations.</div>
</div>
<div class="col-first even-row-color"><code>private boolean</code></div>
<div class="col-second even-row-color"><code><a href="#useExecutorService" class="member-name-link">useExecutorService</a></code></div>
<div class="col-last even-row-color">
<div class="block">Flag indicating whether the executor service is used for background operations.</div>
</div>
<div class="col-first odd-row-color"><code>private <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a></code></div>
<div class="col-second odd-row-color"><code><a href="#walFile" class="member-name-link">walFile</a></code></div>
<div class="col-last odd-row-color">
<div class="block">The WAL file used for write-ahead logging.</div>
</div>
<div class="col-first even-row-color"><code>private <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/DataOutputStream.html" title="class or interface in java.io" class="external-link">DataOutputStream</a></code></div>
<div class="col-second even-row-color"><code><a href="#walOut" class="member-name-link">walOut</a></code></div>
<div class="col-last even-row-color">
<div class="block">The output stream for writing data to the WAL file.</div>
</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(com.storage.engine.Config)" class="member-name-link">StorageDB</a><wbr>(<a href="Config.html" title="class in com.storage.engine">Config</a>&nbsp;config)</code></div>
<div class="col-last even-row-color">
<div class="block">Constructs a StorageDB object with the given configuration.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildIndex()" class="member-name-link">buildIndex</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Builds the index for the data and WAL files.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildIndexFromFile(boolean)" class="member-name-link">buildIndexFromFile</a><wbr>(boolean&nbsp;isWal)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Builds the index from a file.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#close()" class="member-name-link">close</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Closes the database and releases any resources associated with it.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#compact()" class="member-name-link">compact</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Performs compaction of the database.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#flush()" class="member-name-link">flush</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Flushes the write buffer to the WAL file.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#flushNext(java.io.OutputStream,com.storage.engine.Buffer)" class="member-name-link">flushNext</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/OutputStream.html" title="class or interface in java.io" class="external-link">OutputStream</a>&nbsp;out,
 <a href="Buffer.html" title="class in com.storage.engine">Buffer</a>&nbsp;buffer)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Flushes the buffer to the output stream.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Config.html" title="class in com.storage.engine">Config</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getConf()" class="member-name-link">getConf</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Retrieves the configuration object used by the database.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#initExecutorService(int)" class="member-name-link">initExecutorService</a><wbr>(int&nbsp;nThreads)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Initializes the executor service with the specified number of threads.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#initWalOut()" class="member-name-link">initWalOut</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Initializes the write-ahead log output stream.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isCompactionInProgress()" class="member-name-link">isCompactionInProgress</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Checks if compaction is in progress.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isUsingExecutorService()" class="member-name-link">isUsingExecutorService</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Checks if the database is using an executor service for parallel operations.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isWalFileBigEnough(java.io.File)" class="member-name-link">isWalFileBigEnough</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;walFile)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Checks if the write-ahead log (WAL) file is big enough for compaction.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#iterate(boolean,boolean,com.storage.engine.RecordConsumer)" class="member-name-link">iterate</a><wbr>(boolean&nbsp;useLatestWalFile,
 boolean&nbsp;readInMemoryBuffer,
 <a href="RecordConsumer.html" title="interface in com.storage.engine">RecordConsumer</a>&nbsp;consumer)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Iterates over the records in the database and performs the specified actions.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#iterate(com.storage.engine.RecordConsumer)" class="member-name-link">iterate</a><wbr>(<a href="RecordConsumer.html" title="interface in com.storage.engine">RecordConsumer</a>&nbsp;consumer)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Iterates over the records in the database.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/file/Path.html" title="class or interface in java.nio.file" class="external-link">Path</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#move(java.io.File,java.io.File)" class="member-name-link">move</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;file,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;destination)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Function moves a file atomically.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#put(byte%5B%5D,byte%5B%5D)" class="member-name-link">put</a><wbr>(byte[]&nbsp;key,
 byte[]&nbsp;value)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Stores a key-value pair in the database.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#put(byte%5B%5D,byte%5B%5D,int)" class="member-name-link">put</a><wbr>(byte[]&nbsp;key,
 byte[]&nbsp;value,
 int&nbsp;valueOffset)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Stores a key-value pair in the database.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#put(int,byte%5B%5D)" class="member-name-link">put</a><wbr>(int&nbsp;key,
 byte[]&nbsp;value)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Stores a key-value pair in the database.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#put(int,byte%5B%5D,int)" class="member-name-link">put</a><wbr>(int&nbsp;key,
 byte[]&nbsp;value,
 int&nbsp;valueOffset)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Stores a key-value pair in the database.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>byte[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#randomGet(int)" class="member-name-link">randomGet</a><wbr>(int&nbsp;key)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Retrieves the value associated with the specified key from the database.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#recover()" class="member-name-link">recover</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Recovers the database if it's corrupted.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#shouldCompact()" class="member-name-link">shouldCompact</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Checks if the database should be compacted based on the configured conditions.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#shouldFlushBuffer()" class="member-name-link">shouldFlushBuffer</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Checks if the buffer should be flushed based on the configured timeout.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#shutDownExecutorService()" class="member-name-link">shutDownExecutorService</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Shuts down the executor service used for parallel operations.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#size()" class="member-name-link">size</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns the number of records in the database.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="RESERVED_KEY_MARKER">
<h3>RESERVED_KEY_MARKER</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">RESERVED_KEY_MARKER</span></div>
<div class="block">Marker for reserved keys.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../constant-values.html#com.storage.engine.StorageDB.RESERVED_KEY_MARKER">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="FILE_NAME_DATA">
<h3>FILE_NAME_DATA</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">FILE_NAME_DATA</span></div>
<div class="block">The data-file name.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../constant-values.html#com.storage.engine.StorageDB.FILE_NAME_DATA">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="FILE_NAME_WAL">
<h3>FILE_NAME_WAL</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">FILE_NAME_WAL</span></div>
<div class="block">The WAL-file name.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../constant-values.html#com.storage.engine.StorageDB.FILE_NAME_WAL">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="FILE_TYPE_NEXT">
<h3>FILE_TYPE_NEXT</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">FILE_TYPE_NEXT</span></div>
<div class="block">The pointer-name for next file.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../constant-values.html#com.storage.engine.StorageDB.FILE_TYPE_NEXT">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="index">
<h3>index</h3>
<div class="member-signature"><span class="modifiers">private final</span>&nbsp;<span class="return-type"><a href="map/IndexMap.html" title="interface in com.storage.engine.map">IndexMap</a></span>&nbsp;<span class="element-name">index</span></div>
<div class="block">The index map that stores key-value pairs.
 Key: The actual key within this KV store.
 Value: The offset (either in the data file, or in the WAL file).</div>
</section>
</li>
<li>
<section class="detail" id="dataInWalFile">
<h3>dataInWalFile</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/BitSet.html" title="class or interface in java.util" class="external-link">BitSet</a></span>&nbsp;<span class="element-name">dataInWalFile</span></div>
<div class="block">A BitSet indicating which data entries are stored in the WAL file.</div>
</section>
</li>
<li>
<section class="detail" id="rwLock">
<h3>rwLock</h3>
<div class="member-signature"><span class="modifiers">private final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/locks/ReentrantReadWriteLock.html" title="class or interface in java.util.concurrent.locks" class="external-link">ReentrantReadWriteLock</a></span>&nbsp;<span class="element-name">rwLock</span></div>
<div class="block">ReentrantReadWriteLock used for synchronization of read and write operations.</div>
</section>
</li>
<li>
<section class="detail" id="filePool">
<h3>filePool</h3>
<div class="member-signature"><span class="modifiers">private final</span>&nbsp;<span class="return-type"><a href="file_access/RandomAccessFilePool.html" title="class in com.storage.engine.file_access">RandomAccessFilePool</a></span>&nbsp;<span class="element-name">filePool</span></div>
<div class="block">Pool of random access files used for reading and writing data.</div>
</section>
</li>
<li>
<section class="detail" id="buffer">
<h3>buffer</h3>
<div class="member-signature"><span class="modifiers">private final</span>&nbsp;<span class="return-type"><a href="Buffer.html" title="class in com.storage.engine">Buffer</a></span>&nbsp;<span class="element-name">buffer</span></div>
<div class="block">Buffer used for caching data before flushing to disk.</div>
</section>
</li>
<li>
<section class="detail" id="lastBufferFlushTimeMs">
<h3>lastBufferFlushTimeMs</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name">lastBufferFlushTimeMs</span></div>
<div class="block">The timestamp of the last buffer flush operation in milliseconds.</div>
</section>
</li>
<li>
<section class="detail" id="recordSize">
<h3>recordSize</h3>
<div class="member-signature"><span class="modifiers">private final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">recordSize</span></div>
<div class="block">The size of each record in the database.</div>
</section>
</li>
<li>
<section class="detail" id="bytesInWalFile">
<h3>bytesInWalFile</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name">bytesInWalFile</span></div>
<div class="block">The total number of bytes stored in the WAL file.</div>
</section>
</li>
<li>
<section class="detail" id="dbDirFile">
<h3>dbDirFile</h3>
<div class="member-signature"><span class="modifiers">private final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a></span>&nbsp;<span class="element-name">dbDirFile</span></div>
<div class="block">The directory where the database files are stored.</div>
</section>
</li>
<li>
<section class="detail" id="conf">
<h3>conf</h3>
<div class="member-signature"><span class="modifiers">private final</span>&nbsp;<span class="return-type"><a href="Config.html" title="class in com.storage.engine">Config</a></span>&nbsp;<span class="element-name">conf</span></div>
<div class="block">The configuration settings for the database.</div>
</section>
</li>
<li>
<section class="detail" id="compactionState">
<h3>compactionState</h3>
<div class="member-signature"><span class="return-type"><a href="CompactionState.html" title="class in com.storage.engine">CompactionState</a></span>&nbsp;<span class="element-name">compactionState</span></div>
<div class="block">The state of compaction.</div>
</section>
</li>
<li>
<section class="detail" id="dataFile">
<h3>dataFile</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a></span>&nbsp;<span class="element-name">dataFile</span></div>
<div class="block">The data file used for storing key-value data.</div>
</section>
</li>
<li>
<section class="detail" id="walFile">
<h3>walFile</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a></span>&nbsp;<span class="element-name">walFile</span></div>
<div class="block">The WAL file used for write-ahead logging.</div>
</section>
</li>
<li>
<section class="detail" id="walOut">
<h3>walOut</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/DataOutputStream.html" title="class or interface in java.io" class="external-link">DataOutputStream</a></span>&nbsp;<span class="element-name">walOut</span></div>
<div class="block">The output stream for writing data to the WAL file.</div>
</section>
</li>
<li>
<section class="detail" id="tWorker">
<h3>tWorker</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Thread.html" title="class or interface in java.lang" class="external-link">Thread</a></span>&nbsp;<span class="element-name">tWorker</span></div>
<div class="block">The worker thread responsible for background operations.</div>
</section>
</li>
<li>
<section class="detail" id="compactionSync">
<h3>compactionSync</h3>
<div class="member-signature"><span class="modifiers">private final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span>&nbsp;<span class="element-name">compactionSync</span></div>
<div class="block">Synchronization object used for coordinating compaction operations.</div>
</section>
</li>
<li>
<section class="detail" id="compactionLock">
<h3>compactionLock</h3>
<div class="member-signature"><span class="modifiers">private final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span>&nbsp;<span class="element-name">compactionLock</span></div>
<div class="block">Lock object used for synchronizing compaction operations.</div>
</section>
</li>
<li>
<section class="detail" id="shutDown">
<h3>shutDown</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">shutDown</span></div>
<div class="block">Flag indicating whether the database is shut down.</div>
</section>
</li>
<li>
<section class="detail" id="useExecutorService">
<h3>useExecutorService</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">useExecutorService</span></div>
<div class="block">Flag indicating whether the executor service is used for background operations.</div>
</section>
</li>
<li>
<section class="detail" id="exceptionDuringBackgroundOps">
<h3>exceptionDuringBackgroundOps</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Throwable.html" title="class or interface in java.lang" class="external-link">Throwable</a></span>&nbsp;<span class="element-name">exceptionDuringBackgroundOps</span></div>
<div class="block">Throwable object representing an exception occurred during background operations.</div>
</section>
</li>
<li>
<section class="detail" id="LOG">
<h3>LOG</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">org.slf4j.Logger</span>&nbsp;<span class="element-name">LOG</span></div>
<div class="block">The logger for logging messages related to the StorageDB class.</div>
</section>
</li>
<li>
<section class="detail" id="executorService">
<h3>executorService</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ExecutorService.html" title="class or interface in java.util.concurrent" class="external-link">ExecutorService</a></span>&nbsp;<span class="element-name">executorService</span></div>
<div class="block">The executor service for running background tasks.</div>
</section>
</li>
<li>
<section class="detail" id="instancesServed">
<h3>instancesServed</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/ArrayList.html" title="class or interface in java.util" class="external-link">ArrayList</a>&lt;<a href="StorageDB.html" title="class in com.storage.engine">StorageDB</a>&gt;</span>&nbsp;<span class="element-name">instancesServed</span></div>
<div class="block">The list of StorageDB instances served.</div>
</section>
</li>
<li>
<section class="detail" id="commonCompactionSync">
<h3>commonCompactionSync</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span>&nbsp;<span class="element-name">commonCompactionSync</span></div>
<div class="block">The common synchronization object used for coordinating compaction operations across multiple
 instances.</div>
</section>
</li>
<li>
<section class="detail" id="esShutDown">
<h3>esShutDown</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">esShutDown</span></div>
<div class="block">Flag indicating whether the executor service is shut down.</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(com.storage.engine.Config)">
<h3>StorageDB</h3>
<div class="member-signature"><span class="element-name">StorageDB</span><wbr><span class="parameters">(<a href="Config.html" title="class in com.storage.engine">Config</a>&nbsp;config)</span>
   throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Constructs a StorageDB object with the given configuration.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>config</code> - the configuration for the database</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if an I/O error occurs</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="initExecutorService(int)">
<h3>initExecutorService</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">initExecutorService</span><wbr><span class="parameters">(int&nbsp;nThreads)</span></div>
<div class="block">Initializes the executor service with the specified number of threads.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>nThreads</code> - the number of threads</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="initWalOut()">
<h3>initWalOut</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">initWalOut</span>()
                 throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/FileNotFoundException.html" title="class or interface in java.io" class="external-link">FileNotFoundException</a></span></div>
<div class="block">Initializes the write-ahead log output stream.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/FileNotFoundException.html" title="class or interface in java.io" class="external-link">FileNotFoundException</a></code> - if the file is not found</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="shouldFlushBuffer()">
<h3>shouldFlushBuffer</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">shouldFlushBuffer</span>()</div>
<div class="block">Checks if the buffer should be flushed based on the configured timeout.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>true if the buffer should be flushed, false otherwise</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="shouldCompact()">
<h3>shouldCompact</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">shouldCompact</span>()</div>
<div class="block">Checks if the database should be compacted based on the configured conditions.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>true if the database should be compacted, false otherwise</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isWalFileBigEnough(java.io.File)">
<h3>isWalFileBigEnough</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">isWalFileBigEnough</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;walFile)</span></div>
<div class="block">Checks if the write-ahead log (WAL) file is big enough for compaction.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>walFile</code> - the WAL file to check</dd>
<dt>Returns:</dt>
<dd>true if the WAL file is big enough for compaction, false otherwise</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="buildIndex()">
<h3>buildIndex</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">buildIndex</span>()
                 throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Builds the index for the data and WAL files.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if an I/O error occurs</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="buildIndexFromFile(boolean)">
<h3>buildIndexFromFile</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">buildIndexFromFile</span><wbr><span class="parameters">(boolean&nbsp;isWal)</span>
                         throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Builds the index from a file.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>isWal</code> - Determines whether the WAL (Write-Ahead Log) file should be used.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if an I/O error occurs.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="recover()">
<h3>recover</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">recover</span>()
              throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Recovers the database if it's corrupted.
 <p>
 Calling this method brings the database to a state where exactly two files exist: the WAL file and
 the data file.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if an I/O error occurs.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="move(java.io.File,java.io.File)">
<h3>move</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/file/Path.html" title="class or interface in java.nio.file" class="external-link">Path</a></span>&nbsp;<span class="element-name">move</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;file,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;destination)</span>
           throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Function moves a file atomically.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>file</code> - The file to be moved.</dd>
<dd><code>destination</code> - The destination file.</dd>
<dt>Returns:</dt>
<dd>A reference to the destination path.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if an I/O error occurs.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isCompactionInProgress()">
<h3>isCompactionInProgress</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">isCompactionInProgress</span>()</div>
<div class="block">Checks if compaction is in progress. This should always be called from synchronized context.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>true if compaction is in progress, false otherwise</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="compact()">
<h3>compact</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">compact</span>()
             throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Performs compaction of the database.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if an I/O error occurs during compaction</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="flushNext(java.io.OutputStream,com.storage.engine.Buffer)">
<h3>flushNext</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">flushNext</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/OutputStream.html" title="class or interface in java.io" class="external-link">OutputStream</a>&nbsp;out,
 <a href="Buffer.html" title="class in com.storage.engine">Buffer</a>&nbsp;buffer)</span>
                throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Flushes the buffer to the output stream.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>out</code> - the output stream</dd>
<dd><code>buffer</code> - the buffer to flush</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if an I/O error occurs during flushing</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="put(byte[],byte[],int)">
<h3>put</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">put</span><wbr><span class="parameters">(byte[]&nbsp;key,
 byte[]&nbsp;value,
 int&nbsp;valueOffset)</span>
         throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Stores a key-value pair in the database.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>key</code> - the key as a byte array</dd>
<dd><code>value</code> - the value as a byte array</dd>
<dd><code>valueOffset</code> - the offset in the value array</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if an I/O error occurs during the operation</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="put(byte[],byte[])">
<h3>put</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">put</span><wbr><span class="parameters">(byte[]&nbsp;key,
 byte[]&nbsp;value)</span>
         throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Stores a key-value pair in the database.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>key</code> - the key as a byte array</dd>
<dd><code>value</code> - the value as a byte array</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if an I/O error occurs during the operation</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="put(int,byte[])">
<h3>put</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">put</span><wbr><span class="parameters">(int&nbsp;key,
 byte[]&nbsp;value)</span>
         throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Stores a key-value pair in the database.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>key</code> - the key as an integer</dd>
<dd><code>value</code> - the value as a byte array</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if an I/O error occurs during the operation</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="put(int,byte[],int)">
<h3>put</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">put</span><wbr><span class="parameters">(int&nbsp;key,
 byte[]&nbsp;value,
 int&nbsp;valueOffset)</span>
         throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Stores a key-value pair in the database.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>key</code> - the key as an integer</dd>
<dd><code>value</code> - the value as a byte array</dd>
<dd><code>valueOffset</code> - the offset in the value array</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if an I/O error occurs during the operation</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="flush()">
<h3>flush</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">flush</span>()
           throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Flushes the write buffer to the WAL file.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if an I/O error occurs during flushing</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="iterate(com.storage.engine.RecordConsumer)">
<h3>iterate</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">iterate</span><wbr><span class="parameters">(<a href="RecordConsumer.html" title="interface in com.storage.engine">RecordConsumer</a>&nbsp;consumer)</span>
             throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Iterates over the records in the database.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>consumer</code> - the record consumer to handle each record</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if an I/O error occurs during iteration</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="iterate(boolean,boolean,com.storage.engine.RecordConsumer)">
<h3>iterate</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">iterate</span><wbr><span class="parameters">(boolean&nbsp;useLatestWalFile,
 boolean&nbsp;readInMemoryBuffer,
 <a href="RecordConsumer.html" title="interface in com.storage.engine">RecordConsumer</a>&nbsp;consumer)</span>
              throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Iterates over the records in the database and performs the specified actions.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>useLatestWalFile</code> - Indicates whether to use the latest WAL (Write-Ahead Log) file during iteration.</dd>
<dd><code>readInMemoryBuffer</code> - Indicates whether to read records from the in-memory buffer during iteration.</dd>
<dd><code>consumer</code> - The consumer function to apply to each record.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - in case of I/O error during the iteration.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="randomGet(int)">
<h3>randomGet</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">randomGet</span><wbr><span class="parameters">(int&nbsp;key)</span>
                 throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
<a href="exceptions/StorageDBException.html" title="class in com.storage.engine.exceptions">StorageDBException</a></span></div>
<div class="block">Retrieves the value associated with the specified key from the database.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>key</code> - The key for which to retrieve the value.</dd>
<dt>Returns:</dt>
<dd>The value associated with the key, or null if the key is not found.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - in case of I/O error during retrieval.</dd>
<dd><code><a href="exceptions/StorageDBException.html" title="class in com.storage.engine.exceptions">StorageDBException</a></code> - if a storage-related error occurs during retrieval.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="close()">
<h3>close</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">close</span>()
           throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link">InterruptedException</a></span></div>
<div class="block">Closes the database and releases any resources associated with it.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - in case of I/O error during closing.</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link">InterruptedException</a></code> - if the current thread is interrupted while waiting for the operation to complete.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="shutDownExecutorService()">
<h3>shutDownExecutorService</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">shutDownExecutorService</span>()
                                    throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link">InterruptedException</a></span></div>
<div class="block">Shuts down the executor service used for parallel operations.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link">InterruptedException</a></code> - if the current thread is interrupted while waiting for the operation to complete.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getConf()">
<h3>getConf</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Config.html" title="class in com.storage.engine">Config</a></span>&nbsp;<span class="element-name">getConf</span>()</div>
<div class="block">Retrieves the configuration object used by the database.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>The configuration object.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isUsingExecutorService()">
<h3>isUsingExecutorService</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">isUsingExecutorService</span>()</div>
<div class="block">Checks if the database is using an executor service for parallel operations.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd><code>true</code> if the database is using an executor service, <code>false</code> otherwise.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="size()">
<h3>size</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">size</span>()</div>
<div class="block">Returns the number of records in the database.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>The number of records.</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
